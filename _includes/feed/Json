{
    "version": "https://jsonfeed.org/version/1",
    "title": "{{ site.title | xml_escape }}",
    "description": {{ site.description | jsonify }},
    "home_page_url": "{{ "/" | absolute_url }}",
    "feed_url": "{{ "/feed.json" | absolute_url }}",
    "user_comment": "This feed allows you to read the posts from this site in any feed reader that supports the JSON Feed format.",
    "items": [{% for post in site.posts limit:10 %}
        {
            "id": "{{ post.url | absolute_url }}",
            "url": "{{ post.url | absolute_url }}",
            "title": {{ post.title | jsonify }},
            "content_html": {{ post.content | jsonify }},
            "date_published": "{{ post.date | date_to_xmlschema }}",
            "options": {% assign option = "" %}{% for item_hash in site.data %}{% assign item = item_hash[1] %}{% if item.title == post.title %}{% assign option = item.content %}{{ option | jsonify }}{% endif %}{% endfor %}{% if option == "" %}{{ option | jsonify }}{% endif %}             
        }{% unless forloop.last %},{% endunless %}{% endfor %}
    ],
    "sections": [{% assign my_assets = site.assets | sort:0 %}{% assign my_tab = "    " %}{% assign my_size = 2 %}{% assign my_path = "" | split: "," %}{% assign input = "next, output, content, previous, relative_path, id, collection, excerpt, categories, ext, tags, path, url, draft, slug" | split:", " %}{% for asset in my_assets %}{% assign my_split = asset.path | split: "/" %}{% assign size = my_split | size %}{% if size > my_size %}{% assign my_path = my_path | push:size %}{% assign my_size = size %}{% endif %}{% endfor %}{% assign my_assets = site.assets | sort: 'weight' %}{% assign my_paths = "" | split: "," %}{% for my_size in my_path reversed %}{% for asset in my_assets %}{% unless asset.path contains "/head/" %}{% assign my_split = asset.path | split: "/" %}{% assign size = my_split | size %}{% if size == my_size %}{% assign my_paths = my_paths | push:asset %}{% endif %}{% endunless %}{% endfor %}{% endfor %}{% assign my_captures = "" | split: "," %}{% for my_path in my_paths %}{% assign my_split = my_path.path | split: "/" %}{% assign my_part = my_split | size | minus:2 %}{% assign my_size = my_split | size | times: 2 | minus:2 %}{% assign my_dir = my_split[my_part] | prepend: "/" | append: "/" %}{% assign my_title = my_path.title | downcase | prepend: my_dir | append: "/" %}{% assign my_index = "" | split: "," %}{% for my_push in my_paths %}{% if my_push.path contains my_title %}{% assign my_index = my_index | push:forloop.index0 %}{% endif %}{% endfor %}{% capture my_capture %}
{% for i in (1..my_size) %}{{ my_tab }}{% endfor %}{ {% for item in my_path %}{% unless input contains item %}
{% for i in (1..my_size) %}{{ my_tab }}{% endfor %}{{ item | jsonify }}: {{ my_path[item] | jsonify }},{% endunless %}{% endfor %}{% assign my_index_size = my_index | size %}{% if my_index_size > 0 %}
{% for i in (1..my_size) %}{{ my_tab }}{% endfor %}{{ my_tab }}"item": [{% for index in my_index %}{{ my_captures[index] }}{% unless forloop.last %},{% endunless %}{% endfor %}
{% for i in (1..my_size) %}{{ my_tab }}{% endfor %}{{ my_tab }}]{% else %}
{% for i in (1..my_size) %}{{ my_tab }}{% endfor %}{{ my_tab }}"items": []{% endif %}
{% for i in (1..my_size) %}{{ my_tab }}{% endfor %}}{% endcapture %}{% assign my_captures =  my_captures | push:my_capture %}{% endfor %}{% assign my_asset = "" | split: "," %}{% for asset in my_assets %}{% if asset.path contains "/head/" %}{% assign my_asset = my_asset | push:asset %}{% endif %}{% endfor %}{% for asset in my_asset %}{% assign my_title = asset.title | downcase | prepend: "_assets/" | append: "/" %}{% assign my_index = "" | split: "," %}{% for my_path in my_paths %}{% assign my_size = my_path.path | split: "/" | size %}{% if my_size == 3 and my_path.path contains my_title %}{% assign my_index = my_index | push:forloop.index0 %}{% endif %}{% endfor %}
{{ my_tab }}{{ my_tab }}{ {% for item in asset %}{% unless input contains item %}
{{ my_tab }}{{ my_tab }}{{ my_tab }}{{ item | jsonify }}: {{ asset[item] | jsonify }},{% endunless %}{% endfor %}{% assign my_index_size = my_index | size %}{% if my_index_size > 0 %}
{{ my_tab }}{{ my_tab }}{{ my_tab }}"items": [{% for index in my_index %}{{ my_captures[index] }}{% unless forloop.last %},{% endunless %}{% endfor %}
{{ my_tab }}{{ my_tab }}{{ my_tab }}]{% else %}
{{ my_tab }}{{ my_tab }}{{ my_tab }}"items": []{% endif %}
{{ my_tab }}{{ my_tab }}}{% unless forloop.last %},{% endunless %}{% endfor %}
{{ my_tab }}]
}
